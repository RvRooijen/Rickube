<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self';">
  <title>Rickube - Visual kubectl</title>
  <link rel="stylesheet" href="styles/main.css">
  <link rel="stylesheet" href="../node_modules/@xterm/xterm/css/xterm.css">
  <!-- Load xterm as UMD modules via script tags -->
  <script src="../node_modules/@xterm/xterm/lib/xterm.js"></script>
  <script src="../node_modules/@xterm/addon-fit/lib/addon-fit.js"></script>
</head>
<body>
  <!-- Top Bar -->
  <header class="top-bar">
    <div class="app-title">
      <span class="logo">âŽˆ</span>
      <h1>Rickube</h1>
    </div>
    <div class="top-bar-controls">
      <div class="context-selector">
        <label for="context-select">Context:</label>
        <select id="context-select">
          <option value="">Loading...</option>
        </select>
      </div>
      <div class="refresh-indicator" id="refresh-indicator">
        <span class="spinner"></span>
        <span class="refresh-text">Refreshing...</span>
      </div>
      <div class="connection-status" id="connection-status">
        <span class="status-dot"></span>
        <span class="status-text">Checking...</span>
      </div>
    </div>
  </header>

  <!-- Main Content Area -->
  <main class="main-content">
    <!-- Left Sidebar: Namespaces -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2>Namespaces</h2>
        <button class="refresh-btn" id="refresh-namespaces" title="Refresh namespaces">â†»</button>
      </div>
      <div class="sidebar-filter">
        <label class="toggle-filter">
          <input type="checkbox" id="filter-accessible" checked>
          <span class="toggle-slider"></span>
          <span class="toggle-label">Alleen toegankelijke</span>
        </label>
      </div>
      <div class="namespace-list" id="namespace-list">
        <div class="loading">Loading namespaces...</div>
      </div>
    </aside>

    <!-- Resize Handle 1 -->
    <div class="panel-resize-handle" id="resize-handle-1"></div>

    <!-- Center: Main Content Area -->
    <section class="main-view-container" id="main-view-container">
      <!-- Upper section: Pods/Workloads -->
      <div class="main-view-upper">
        <!-- Main View Tabs -->
        <div class="main-view-tabs">
          <button class="main-view-tab active" data-view="pods">Pods</button>
          <button class="main-view-tab" data-view="workloads">Workloads</button>
          <button class="main-view-tab" data-view="networking">Networking</button>
          <button class="main-view-tab" data-view="config">Config</button>
          <button class="main-view-tab" data-view="storage">Storage</button>
          <button class="main-view-tab" data-view="cluster">Cluster</button>
          <div class="main-view-info">
            <span id="namespace-name">Select a namespace</span>
            <span class="pod-count" id="pod-count"></span>
          </div>
        </div>

        <!-- Pods View -->
        <div class="main-view-content active" id="pods-view">
          <div class="pod-grid" id="pod-grid">
            <div class="empty-state">
              <p>Select a namespace to view pods</p>
            </div>
          </div>
        </div>

        <!-- Workloads View -->
        <div class="main-view-content" id="workloads-view">
          <div class="workloads-container" id="workloads-container">
            <div class="empty-state">
              <p>Select a namespace to view workloads</p>
            </div>
          </div>
        </div>

        <!-- Networking View -->
        <div class="main-view-content" id="networking-view">
          <div class="networking-container" id="networking-container">
            <div class="empty-state">
              <p>Select a namespace to view networking resources</p>
            </div>
          </div>
        </div>

        <!-- Config View -->
        <div class="main-view-content" id="config-view">
          <div class="config-container" id="config-container">
            <div class="empty-state">
              <p>Select a namespace to view config resources</p>
            </div>
          </div>
        </div>

        <!-- Storage View -->
        <div class="main-view-content" id="storage-view">
          <div class="storage-container" id="storage-container">
            <div class="empty-state">
              <p>Select a namespace to view storage resources</p>
            </div>
          </div>
        </div>

        <!-- Cluster View -->
        <div class="main-view-content" id="cluster-view">
          <div class="cluster-container" id="cluster-container">
            <div class="empty-state">
              <p>Loading cluster info...</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Horizontal Resize Handle -->
      <div class="horizontal-resize-handle" id="events-resize-handle"></div>

      <!-- Lower section: Events Panel -->
      <div class="events-panel" id="events-panel">
        <div class="events-panel-header">
          <div class="events-panel-title">
            <span class="events-icon">âš¡</span>
            <span>Events</span>
            <span class="events-count" id="events-count"></span>
            <span class="events-warning-count" id="events-warning-count"></span>
          </div>
          <div class="events-panel-controls">
            <button class="events-control-btn" id="events-filter-all" title="All events">All</button>
            <button class="events-control-btn" id="events-filter-warnings" title="Warnings only">Warnings</button>
            <button class="events-control-btn" id="events-clear" title="Clear">Clear</button>
            <button class="events-control-btn" id="events-toggle" title="Toggle panel">â–¼</button>
          </div>
        </div>
        <div class="events-panel-content" id="events-panel-content">
          <div class="events-list" id="events-list">
            <div class="empty-state">
              <p>Select a namespace to view events</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Resize Handle 2 -->
    <div class="panel-resize-handle" id="resize-handle-2"></div>

    <!-- Right Panel: Context-aware tabs -->
    <aside class="right-panel" id="right-panel">
      <div class="panel-tabs">
        <button class="tab-btn active" data-tab="details">Details</button>
        <button class="tab-btn" data-tab="logs">Logs</button>
        <button class="tab-btn" data-tab="terminal">Terminal</button>
        <button class="tab-btn" data-tab="files">Files</button>
      </div>

      <!-- Details Tab -->
      <div class="tab-content active" id="details-tab">
        <div class="details-container">
          <div class="empty-state">
            <p>Select a pod to view details</p>
          </div>
        </div>
      </div>

      <!-- Logs Tab -->
      <div class="tab-content" id="logs-tab">
        <div class="logs-controls">
          <button class="btn btn-small" id="logs-pause">Pause</button>
          <button class="btn btn-small" id="logs-clear">Clear</button>
          <button class="btn btn-small" id="logs-download">Download</button>
        </div>
        <div class="logs-container" id="logs-container">
          <div class="empty-state">
            <p>Select a pod to view logs</p>
          </div>
        </div>
      </div>

      <!-- Terminal Tab -->
      <div class="tab-content" id="terminal-tab">
        <div class="terminal-controls">
          <button class="btn btn-small" id="copy-exec-command">ðŸ“‹ Copy kubectl exec command</button>
        </div>
        <div class="terminal-instructions">
          <div class="empty-state" id="terminal-empty">
            <p>Selecteer een pod om het kubectl exec commando te kopiÃ«ren</p>
          </div>
          <div class="command-display" id="command-display" style="display: none;">
            <h3>kubectl exec command:</h3>
            <div class="command-box">
              <code id="kubectl-command"></code>
            </div>
            <p class="help-text">Klik op de button hierboven om het commando te kopiÃ«ren en plak het in je terminal.</p>
          </div>
        </div>
      </div>

      <!-- Files Tab -->
      <div class="tab-content" id="files-tab">
        <div class="files-container" id="files-container">
          <div class="empty-state">
            <p>Select a pod to browse files</p>
          </div>
        </div>
      </div>
    </aside>
  </main>

  <!-- Error Toast -->
  <div class="toast" id="error-toast">
    <span class="toast-message"></span>
    <button class="toast-close">Ã—</button>
  </div>

  <!-- Scale Modal -->
  <div class="modal-overlay" id="scale-modal">
    <div class="modal">
      <div class="modal-header">
        <h3>Scale <span id="scale-resource-name"></span></h3>
        <button class="modal-close" id="scale-modal-close">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="scale-replicas">Replicas:</label>
          <input type="number" id="scale-replicas" min="0" max="100" value="1">
        </div>
        <p class="modal-info">Current: <span id="scale-current"></span> replicas</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="scale-cancel">Cancel</button>
        <button class="btn" id="scale-confirm">Scale</button>
      </div>
    </div>
  </div>

  <!-- Confirm Modal -->
  <div class="modal-overlay" id="confirm-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 id="confirm-title">Confirm Action</h3>
        <button class="modal-close" id="confirm-modal-close">Ã—</button>
      </div>
      <div class="modal-body">
        <p id="confirm-message">Are you sure?</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="confirm-cancel">Cancel</button>
        <button class="btn btn-danger" id="confirm-ok">Confirm</button>
      </div>
    </div>
  </div>

  <!-- Rollback Modal -->
  <div class="modal-overlay" id="rollback-modal">
    <div class="modal modal-wide">
      <div class="modal-header">
        <h3>Rollback: <span id="rollback-deployment-name"></span></h3>
        <button class="modal-close" id="rollback-modal-close">Ã—</button>
      </div>
      <div class="modal-body">
        <p class="rollback-info">Select a revision to rollback to:</p>
        <div class="rollback-current" id="rollback-current"></div>
        <div class="rollback-history" id="rollback-history">
          <div class="loading-spinner">Loading history...</div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="rollback-cancel">Cancel</button>
        <button class="btn btn-danger" id="rollback-confirm" disabled>Rollback</button>
      </div>
    </div>
  </div>

  <!-- Port Forward Modal -->
  <div class="modal-overlay" id="port-forward-modal">
    <div class="modal">
      <div class="modal-header">
        <h3>Port Forward: <span id="pf-resource-name"></span></h3>
        <button class="modal-close" id="pf-modal-close">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="pf-local-port">Local Port:</label>
          <input type="number" id="pf-local-port" min="1" max="65535" value="8080">
        </div>
        <div class="form-group">
          <label for="pf-remote-port">Remote Port:</label>
          <input type="number" id="pf-remote-port" min="1" max="65535" value="80">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="pf-cancel">Cancel</button>
        <button class="btn" id="pf-start">Start Forward</button>
      </div>
    </div>
  </div>

  <!-- ConfigMap View Modal -->
  <div class="modal-overlay" id="configmap-modal">
    <div class="modal modal-wide">
      <div class="modal-header">
        <h3>ConfigMap: <span id="configmap-modal-name"></span></h3>
        <button class="modal-close" id="configmap-modal-close">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="config-data-list" id="configmap-data-list"></div>
      </div>
    </div>
  </div>

  <!-- Secret View Modal -->
  <div class="modal-overlay" id="secret-modal">
    <div class="modal modal-wide">
      <div class="modal-header">
        <h3>Secret: <span id="secret-modal-name"></span></h3>
        <button class="modal-close" id="secret-modal-close">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="secret-warning">
          <span class="warning-icon">!</span>
          These values contain sensitive data. Be careful when revealing.
        </div>
        <div class="secret-data-list" id="secret-data-list"></div>
      </div>
    </div>
  </div>

  <!-- Operation Progress Modal -->
  <div class="modal-overlay" id="operation-modal">
    <div class="modal modal-wide">
      <div class="modal-header">
        <h3 id="operation-title">Operation in Progress</h3>
        <button class="modal-close" id="operation-modal-close">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="operation-command" id="operation-command"></div>
        <div class="operation-status">
          <div class="operation-status-header">
            <span class="operation-status-label">Status:</span>
            <span class="operation-status-value" id="operation-status-value">Starting...</span>
          </div>
          <div class="operation-progress">
            <div class="progress-bar">
              <div class="progress-fill" id="operation-progress-fill"></div>
            </div>
            <span class="progress-text" id="operation-progress-text">0/0</span>
          </div>
        </div>
        <div class="operation-details" id="operation-details">
          <div class="operation-section">
            <h4>Rollout Status</h4>
            <div class="operation-stats" id="operation-stats"></div>
          </div>
          <div class="operation-section">
            <h4>Recent Events</h4>
            <div class="operation-events" id="operation-events"></div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="operation-close">Close</button>
      </div>
    </div>
  </div>

  <!-- Port Forwards Panel (floating) -->
  <div class="port-forwards-panel" id="port-forwards-panel">
    <div class="port-forwards-header">
      <span class="port-forwards-title">Port Forwards</span>
      <span class="port-forwards-count" id="port-forwards-count">0</span>
      <button class="btn btn-small btn-danger" id="stop-all-forwards">Stop All</button>
      <button class="port-forwards-toggle" id="port-forwards-toggle">â–¼</button>
    </div>
    <div class="port-forwards-content" id="port-forwards-content">
      <div class="port-forwards-list" id="port-forwards-list">
        <div class="port-forwards-empty">No active port forwards</div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script type="module" src="app.js"></script>
</body>
</html>
